<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ninja Projects Showcase</title>

  <!-- Code Ninjas-style modern font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css" />
</head>
<body class="container">
  <div class="app-shell">
    <header class="header">
      <div class="header-top">
        <div class="brand">
          <div class="brand-logo" aria-hidden="true">CN</div>
          <div class="brand-text">
            <span class="brand-title">Code Ninjas</span>
            <span class="brand-subtitle">Student Game Gallery</span>
          </div>
        </div>

        <div class="header-meta">
          <span id="project-count" class="project-count">0 projects</span>
        </div>
      </div>

      <div class="header-bottom">
        <h1>Ninja Projects Showcase</h1>
        <p class="subtitle">
          Discover and play games built in MakeCode Arcade by Code Ninjas students.
        </p>

        <div class="toolbar">
          <label class="search">
            <span class="search-icon" aria-hidden="true">üîç</span>
            <input
              id="search-input"
              type="search"
              placeholder="Search by title or student‚Ä¶"
              aria-label="Search projects by title or student"
            />
          </label>
        </div>
      </div>
    </header>

    <main class="main">
      <ul id="project-list" class="project-list" aria-live="polite"></ul>
    </main>
  </div>

  <script>
    let allProjects = [];

    function formatCount(count) {
      return count === 1 ? '1 project' : `${count} projects`;
    }

    function renderProjects(filterText = '') {
      const list = document.getElementById('project-list');
      const countEl = document.getElementById('project-count');
      const query = filterText.trim().toLowerCase();

      let visible = allProjects;
      if (query) {
        visible = allProjects.filter((proj) =>
          proj.project.toLowerCase().includes(query) ||
          proj.student.toLowerCase().includes(query)
        );
      }

      list.innerHTML = '';

      if (!visible.length) {
        const message = allProjects.length === 0
          ? 'No projects yet ‚Äî check back soon!'
          : `No matches for ‚Äú${filterText}‚Äù.`;
        list.innerHTML = `<li class="empty">${message}</li>`;
        countEl.textContent = formatCount(0);
        return;
      }

      visible.forEach((proj) => {
        const li = document.createElement('li');
        li.className = 'project-card';
        li.innerHTML = `
          <a class="project-link" href="project.html?id=${proj.id}">
            <div class="project-tag">MakeCode Arcade</div>
            <h2>${proj.project}</h2>
            <p class="project-student">By ${proj.student}</p>
          </a>
        `;
        list.appendChild(li);
      });

      countEl.textContent = formatCount(visible.length);
    }

    async function loadProjects() {
      const response = await fetch('projects.json');
      const projects = await response.json();
      // keep original index so links stay stable when filtering
      allProjects = projects.map((proj, index) => ({ ...proj, id: index }));
      renderProjects();
    }

    document.addEventListener('DOMContentLoaded', () => {
      const searchInput = document.getElementById('search-input');

      searchInput.addEventListener('input', (event) => {
        renderProjects(event.target.value);
      });

      // ESC clears the search
      searchInput.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          event.target.value = '';
          renderProjects('');
          event.target.blur();
        }
      });

      loadProjects();
    });
  </script>
</body>
</html>
